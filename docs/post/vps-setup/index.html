<!doctype html><html lang=en dir=auto><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>VPS setup | Tarun Vellishetty</title><meta name=keywords content="openvpn,pihole,transmission,bittorrent,filebrowser"><meta name=description content="Setup for my VPS instance that I use for VPN / Torrents. Documenting it so that I can re-setup if it gets wrecked."><meta name=author content="Tarun Vellishetty"><link rel=canonical href=https://tarunvelli.site/post/vps-setup/><link crossorigin=anonymous href=/assets/css/stylesheet.min.08c4fda488014b6530572a4b5e695eb6bfb7f017b14fdaceae7fa1bd9a202afd.css integrity="sha256-CMT9pIgBS2UwVypLXmletr+38BexT9rOrn+hvZogKv0=" rel="preload stylesheet" as=style><script defer crossorigin=anonymous src=/assets/js/highlight.min.b95bacdc39e37a332a9f883b1e78be4abc1fdca2bc1f2641f55e3cd3dabd4d61.js integrity="sha256-uVus3DnjejMqn4g7Hni+Srwf3KK8HyZB9V4809q9TWE=" onload=hljs.initHighlightingOnLoad()></script>
<link rel=icon href=https://tarunvelli.site/favicon.ico><link rel=icon type=image/png sizes=16x16 href=https://tarunvelli.site/favicon-16x16.png><link rel=icon type=image/png sizes=32x32 href=https://tarunvelli.site/favicon-32x32.png><link rel=apple-touch-icon href=https://tarunvelli.site/apple-touch-icon.png><link rel=mask-icon href=https://tarunvelli.site/safari-pinned-tab.svg><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><meta name=generator content="Hugo 0.108.0"><noscript><style>#theme-toggle,.top-link{display:none}</style><style>@media(prefers-color-scheme:dark){:root{--theme:rgb(29, 30, 32);--entry:rgb(46, 46, 51);--primary:rgb(218, 218, 219);--secondary:rgb(155, 156, 157);--tertiary:rgb(65, 66, 68);--content:rgb(196, 196, 197);--hljs-bg:rgb(46, 46, 51);--code-bg:rgb(55, 56, 62);--border:rgb(51, 51, 51)}.list{background:var(--theme)}.list:not(.dark)::-webkit-scrollbar-track{background:0 0}.list:not(.dark)::-webkit-scrollbar-thumb{border-color:var(--theme)}}</style></noscript><script type=application/javascript>var doNotTrack=!1;doNotTrack||(function(e,t,n,s,o,i,a){e.GoogleAnalyticsObject=o,e[o]=e[o]||function(){(e[o].q=e[o].q||[]).push(arguments)},e[o].l=1*new Date,i=t.createElement(n),a=t.getElementsByTagName(n)[0],i.async=1,i.src=s,a.parentNode.insertBefore(i,a)}(window,document,"script","https://www.google-analytics.com/analytics.js","ga"),ga("create","UA-123-45","auto"),ga("send","pageview"))</script><meta property="og:title" content="VPS setup"><meta property="og:description" content="Setup for my VPS instance that I use for VPN / Torrents. Documenting it so that I can re-setup if it gets wrecked."><meta property="og:type" content="article"><meta property="og:url" content="https://tarunvelli.site/post/vps-setup/"><meta property="article:section" content="post"><meta property="article:published_time" content="2023-07-22T00:00:00+00:00"><meta property="article:modified_time" content="2023-07-22T00:00:00+00:00"><meta property="og:site_name" content="Tarun Vellishetty"><meta name=twitter:card content="summary"><meta name=twitter:title content="VPS setup"><meta name=twitter:description content="Setup for my VPS instance that I use for VPN / Torrents. Documenting it so that I can re-setup if it gets wrecked."><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Posts","item":"https://tarunvelli.site/post/"},{"@type":"ListItem","position":2,"name":"VPS setup","item":"https://tarunvelli.site/post/vps-setup/"}]}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"VPS setup","name":"VPS setup","description":"Setup for my VPS instance that I use for VPN / Torrents. Documenting it so that I can re-setup if it gets wrecked.","keywords":["openvpn","pihole","transmission","bittorrent","filebrowser"],"articleBody":"Initial server setup Steps to take to setup user and firewall on a new server instance\nDetailed steps\nVim Better than nano sudo apt update sudo apt -y install vim Oh My Zsh sh -c \"$(curl -fsSL https://raw.githubusercontent.com/ohmyzsh/ohmyzsh/master/tools/install.sh)\" Oxide theme Nginx To map subdomains to ports\nInstall nginx\nsudo apt update sudo apt install nginx Allow through firewall sudo ufw allow 'Nginx Full' sudo ufw delete allow 'Nginx HTTP' Server block without TLS/SSL server { listen 80; listen [::]:80; server_name ; location / { proxy_set_header X-Forwarded-For $remote_addr; proxy_set_header Host $http_host; proxy_pass \"http://127.0.0.1:\"; } } After running certbot server { server_name ; location / { proxy_set_header X-Forwarded-For $remote_addr; proxy_set_header Host $http_host; proxy_pass \"http://127.0.0.1:\"; } listen 443 ssl; # managed by Certbot ssl_certificate /etc/letsencrypt/live//fullchain.pem; # managed by Certbot ssl_certificate_key /etc/letsencrypt/live//privkey.pem; # managed by Certbot include /etc/letsencrypt/options-ssl-nginx.conf; # managed by Certbot ssl_dhparam /etc/letsencrypt/ssl-dhparams.pem; # managed by Certbot } server { if ($host = ) { return 301 https://$host$request_uri; } # managed by Certbot listen 80; server_name ; return 404; # managed by Certbot } Detailed steps Lets Encrypt Free TLS/SSL certificates\nInstall certbot\nsudo apt install certbot python3-certbot-nginx Obtaining SSL cert sudo certbot --nginx -d example.com -d www.example.com Detailed steps OpenVPN + Pi-hole VPN with built in adblocker\nDetailed steps\nTransmission Torrents ♥\nInstall\nsudo add-apt-repository ppa:transmissionbt/ppa sudo apt-get update sudo apt-get install transmission-cli transmission-common transmission-daemon Configure sudo service transmission-daemon stop sudo vim /var/lib/transmission-daemon/info/settings.json Change the following \"rpc-password\": \"\", \"rpc-username\": \"\", \"rpc-whitelist\": \"127.0.0.1,192.168.*.*\", \"umask\": 2, Restart sudo service transmission-daemon start Detailed steps Filebrowser View files on the server via browser curl -fsSL https://raw.githubusercontent.com/filebrowser/get/master/get.sh | bash filebrowser -r /path/to/your/files Detailed steps ","wordCount":"269","inLanguage":"en","datePublished":"2023-07-22T00:00:00Z","dateModified":"2023-07-22T00:00:00Z","author":{"@type":"Person","name":"Tarun Vellishetty"},"mainEntityOfPage":{"@type":"WebPage","@id":"https://tarunvelli.site/post/vps-setup/"},"publisher":{"@type":"Organization","name":"Tarun Vellishetty","logo":{"@type":"ImageObject","url":"https://tarunvelli.site/favicon.ico"}}}</script></head><body id=top><script>localStorage.getItem("pref-theme")==="dark"?document.body.classList.add("dark"):localStorage.getItem("pref-theme")==="light"?document.body.classList.remove("dark"):window.matchMedia("(prefers-color-scheme: dark)").matches&&document.body.classList.add("dark")</script><header class=header><nav class=nav><div class=logo><a href=https://tarunvelli.site/ accesskey=h title="Home (Alt + H)">Home</a>
<span class=logo-switches><button id=theme-toggle accesskey=t title="(Alt + T)"><svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg><svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></button></span></div><ul id=menu><li><a href=https://tarunvelli.site/page/about title=About><span>About</span></a></li><li><a href=https://tarunvelli.site/post/ title=Blog><span>Blog</span></a></li><li><a href=https://tarunvelli.site/project/ title=Projects><span>Projects</span></a></li><li><a href=https://tarunvelli.site/tags/ title=Tags><span>Tags</span></a></li></ul></nav></header><main class=main><article class=post-single><header class=post-header><div class=breadcrumbs><a href=https://tarunvelli.site/>Home</a>&nbsp;»&nbsp;<a href=https://tarunvelli.site/post/>Posts</a></div><h1 class=post-title>VPS setup</h1><div class=post-meta>July 22, 2023&nbsp;·&nbsp;2 min&nbsp;·&nbsp;Tarun Vellishetty&nbsp;|&nbsp;<a href=https://github.com/tarunvelli/tarunvelli.github.io/blob/master/content/post/vps-setup.md rel="noopener noreferrer" target=_blank>Suggest Changes</a></div></header><div class=post-content><h1 id=initial-server-setup>Initial server setup<a hidden class=anchor aria-hidden=true href=#initial-server-setup>#</a></h1><ul><li><p>Steps to take to setup user and firewall on a new server instance</p></li><li><p><a href=https://www.digitalocean.com/community/tutorials/initial-server-setup-with-ubuntu-22-04>Detailed steps</a></p></li></ul><h1 id=vim>Vim<a hidden class=anchor aria-hidden=true href=#vim>#</a></h1><ul><li>Better than nano</li></ul><pre tabindex=0><code>sudo apt update
sudo apt -y install vim
</code></pre><h1 id=oh-my-zsh>Oh My Zsh<a hidden class=anchor aria-hidden=true href=#oh-my-zsh>#</a></h1><pre tabindex=0><code>sh -c &#34;$(curl -fsSL https://raw.githubusercontent.com/ohmyzsh/ohmyzsh/master/tools/install.sh)&#34;
</code></pre><ul><li><a href=https://github.com/ohmyzsh/ohmyzsh/wiki/External-themes#oxide>Oxide theme</a></li></ul><h1 id=nginx>Nginx<a hidden class=anchor aria-hidden=true href=#nginx>#</a></h1><ul><li><p>To map subdomains to ports</p></li><li><p>Install nginx</p></li></ul><pre tabindex=0><code>sudo apt update
sudo apt install nginx
</code></pre><ul><li>Allow through firewall</li></ul><pre tabindex=0><code>sudo ufw allow &#39;Nginx Full&#39;
sudo ufw delete allow &#39;Nginx HTTP&#39;
</code></pre><ul><li>Server block without TLS/SSL</li></ul><pre tabindex=0><code>server {
    listen 80;
    listen [::]:80;

    server_name &lt;subdomain.domain.tld&gt;;

    location / {
        proxy_set_header   X-Forwarded-For $remote_addr;
        proxy_set_header   Host $http_host;
        proxy_pass         &#34;http://127.0.0.1:&lt;port&gt;&#34;;
    }
}
</code></pre><ul><li>After running certbot</li></ul><pre tabindex=0><code>server {
    server_name &lt;subdomain.domain.tld&gt;;

    location / {
        proxy_set_header   X-Forwarded-For $remote_addr;
        proxy_set_header   Host $http_host;
        proxy_pass         &#34;http://127.0.0.1:&lt;port&gt;&#34;;
    }

    listen 443 ssl; # managed by Certbot
    ssl_certificate /etc/letsencrypt/live/&lt;subdomain.domain.tld&gt;/fullchain.pem; # managed by Certbot
    ssl_certificate_key /etc/letsencrypt/live/&lt;subdomain.domain.tld&gt;/privkey.pem; # managed by Certbot
    include /etc/letsencrypt/options-ssl-nginx.conf; # managed by Certbot
    ssl_dhparam /etc/letsencrypt/ssl-dhparams.pem; # managed by Certbot

}
server {
    if ($host = &lt;subdomain.domain.tld&gt;) {
        return 301 https://$host$request_uri;
    } # managed by Certbot


    listen 80;
    server_name &lt;subdomain.domain.tld&gt;;
    return 404; # managed by Certbot
}
</code></pre><ul><li><a href=https://www.digitalocean.com/community/tutorials/how-to-install-nginx-on-ubuntu-22-04>Detailed steps</a></li></ul><h1 id=lets-encrypt>Lets Encrypt<a hidden class=anchor aria-hidden=true href=#lets-encrypt>#</a></h1><ul><li><p>Free TLS/SSL certificates</p></li><li><p>Install certbot</p></li></ul><pre tabindex=0><code>sudo apt install certbot python3-certbot-nginx
</code></pre><ul><li>Obtaining SSL cert</li></ul><pre tabindex=0><code>sudo certbot --nginx -d example.com -d www.example.com
</code></pre><ul><li><a href=https://www.digitalocean.com/community/tutorials/how-to-secure-nginx-with-let-s-encrypt-on-ubuntu-20-04>Detailed steps</a></li></ul><h1 id=openvpn--pi-hole>OpenVPN + Pi-hole<a hidden class=anchor aria-hidden=true href=#openvpn--pi-hole>#</a></h1><ul><li><p>VPN with built in adblocker</p></li><li><p><a href=https://docs.pi-hole.net/guides/vpn/openvpn/installation/>Detailed steps</a></p></li></ul><h1 id=transmission>Transmission<a hidden class=anchor aria-hidden=true href=#transmission>#</a></h1><ul><li><p>Torrents ♥</p></li><li><p>Install</p></li></ul><pre tabindex=0><code>sudo add-apt-repository ppa:transmissionbt/ppa
sudo apt-get update
sudo apt-get install transmission-cli transmission-common transmission-daemon
</code></pre><ul><li>Configure</li></ul><pre tabindex=0><code>sudo service transmission-daemon stop
sudo vim /var/lib/transmission-daemon/info/settings.json
</code></pre><ul><li>Change the following</li></ul><pre tabindex=0><code>&#34;rpc-password&#34;: &#34;&lt;new password&gt;&#34;,
&#34;rpc-username&#34;: &#34;&lt;new username&gt;&#34;,
&#34;rpc-whitelist&#34;: &#34;127.0.0.1,192.168.*.*&#34;,
&#34;umask&#34;: 2,
</code></pre><ul><li>Restart</li></ul><pre tabindex=0><code>sudo service transmission-daemon start
</code></pre><ul><li><a href=https://help.ubuntu.com/community/TransmissionHowTo>Detailed steps</a></li></ul><h1 id=filebrowser>Filebrowser<a hidden class=anchor aria-hidden=true href=#filebrowser>#</a></h1><ul><li>View files on the server via browser</li></ul><pre tabindex=0><code>curl -fsSL https://raw.githubusercontent.com/filebrowser/get/master/get.sh | bash
filebrowser -r /path/to/your/files
</code></pre><ul><li><a href=https://filebrowser.org/installation>Detailed steps</a></li></ul></div><footer class=post-footer><ul class=post-tags><li><a href=https://tarunvelli.site/tags/openvpn/>openvpn</a></li><li><a href=https://tarunvelli.site/tags/pihole/>pihole</a></li><li><a href=https://tarunvelli.site/tags/transmission/>transmission</a></li><li><a href=https://tarunvelli.site/tags/bittorrent/>bittorrent</a></li><li><a href=https://tarunvelli.site/tags/filebrowser/>filebrowser</a></li></ul><nav class=paginav><a class=next href=https://tarunvelli.site/post/how-cryptocurrency-works/><span class=title>Next Page »</span><br><span>How Cryptocurrency works</span></a></nav></footer></article></main><footer class=footer><span>&copy; 2023 <a href=https://tarunvelli.site/>Tarun Vellishetty</a></span></footer><a href=#top aria-label="go to top" title="Go to Top (Alt + G)" class=top-link id=top-link accesskey=g><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentcolor"><path d="M12 6H0l6-6z"/></svg></a><script>let menu=document.getElementById("menu");menu.scrollLeft=localStorage.getItem("menu-scroll-position"),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)},document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(e){e.preventDefault();var t=this.getAttribute("href").substr(1);window.matchMedia("(prefers-reduced-motion: reduce)").matches?document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView({behavior:"smooth"}),t==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${t}`)})})</script><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script><script>document.getElementById("theme-toggle").addEventListener("click",()=>{document.body.className.includes("dark")?(document.body.classList.remove("dark"),localStorage.setItem("pref-theme","light")):(document.body.classList.add("dark"),localStorage.setItem("pref-theme","dark"))})</script></body></html>