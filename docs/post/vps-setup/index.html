<!DOCTYPE html>
<html lang="en-us">
  <head>
    <title>VPS setup | Tarun Vellishetty</title>

    <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">    
<meta name="viewport" content="width=device-width,minimum-scale=1">
<meta name="description" content="Setup for my VPS instance that I use for VPN / Torrents. Documenting it so that I can re-setup if it gets wrecked.">
<meta name="generator" content="Hugo 0.108.0">


  <META NAME="ROBOTS" CONTENT="NOINDEX, NOFOLLOW">


<link rel="stylesheet" href="/css/style.css">



<link rel="shortcut icon" href="/images/favicon.ico" type="image/x-icon" />








  </head>

  <body>
    <nav class="navigation">
	
		<a href="/"> <span class="arrow">←</span>Home</a>
	

	<a href="/about">About</a>
	
		<a href="/project">Projects</a>
	
		<a href="/post">Blog</a>
	
	<a href="/tags">Tags</a>

	
	  <a class="button" href="https://tarunvelli.site/index.xml">Subscribe</a>
	
</nav>


    <main class="main">
      

<section id="single">
    <h1 class="title">VPS setup</h1>

    <div class="tip">
        <time datetime="2023-07-22 00:00:00 &#43;0000 UTC">Jul 22, 2023</time>
        <span class="split">
          ·
        </span>
        <span>
          276 words
        </span>
        <span class="split">
          ·
        </span>
        <span>
          2 minute read
        </span>
    </div>

    
    


    <div class="content">
      <h1 id="initial-server-setup">Initial server setup <a href="#initial-server-setup" class="anchor">🔗</a></h1><ul>
<li>
<p>Steps to take to setup user and firewall on a new server instance</p>
</li>
<li>
<p><a href="https://www.digitalocean.com/community/tutorials/initial-server-setup-with-ubuntu-22-04" target="_blank" rel="noopener">Detailed steps</a></p>
</li>
</ul>
<h1 id="vim">Vim <a href="#vim" class="anchor">🔗</a></h1><ul>
<li>Better than nano</li>
</ul>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-fallback" data-lang="fallback"><span style="display:flex;"><span>sudo apt update
</span></span><span style="display:flex;"><span>sudo apt -y install vim
</span></span></code></pre></div><h1 id="oh-my-zsh">Oh My Zsh <a href="#oh-my-zsh" class="anchor">🔗</a></h1><div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-fallback" data-lang="fallback"><span style="display:flex;"><span>sh -c &#34;$(curl -fsSL https://raw.githubusercontent.com/ohmyzsh/ohmyzsh/master/tools/install.sh)&#34;
</span></span></code></pre></div><ul>
<li><a href="https://github.com/ohmyzsh/ohmyzsh/wiki/External-themes#oxide" target="_blank" rel="noopener">Oxide theme</a></li>
</ul>
<h1 id="nginx">Nginx <a href="#nginx" class="anchor">🔗</a></h1><ul>
<li>
<p>To map subdomains to ports</p>
</li>
<li>
<p>Install nginx</p>
</li>
</ul>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-fallback" data-lang="fallback"><span style="display:flex;"><span>sudo apt update
</span></span><span style="display:flex;"><span>sudo apt install nginx
</span></span></code></pre></div><ul>
<li>Allow through firewall</li>
</ul>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-fallback" data-lang="fallback"><span style="display:flex;"><span>sudo ufw allow &#39;Nginx Full&#39;
</span></span><span style="display:flex;"><span>sudo ufw delete allow &#39;Nginx HTTP&#39;
</span></span></code></pre></div><ul>
<li>Server block without TLS/SSL</li>
</ul>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-fallback" data-lang="fallback"><span style="display:flex;"><span>server {
</span></span><span style="display:flex;"><span>    listen 80;
</span></span><span style="display:flex;"><span>    listen [::]:80;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    server_name &lt;subdomain.domain.tld&gt;;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    location / {
</span></span><span style="display:flex;"><span>        proxy_set_header   X-Forwarded-For $remote_addr;
</span></span><span style="display:flex;"><span>        proxy_set_header   Host $http_host;
</span></span><span style="display:flex;"><span>        proxy_pass         &#34;http://127.0.0.1:&lt;port&gt;&#34;;
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><ul>
<li>After running certbot</li>
</ul>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-fallback" data-lang="fallback"><span style="display:flex;"><span>server {
</span></span><span style="display:flex;"><span>    server_name &lt;subdomain.domain.tld&gt;;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    location / {
</span></span><span style="display:flex;"><span>        proxy_set_header   X-Forwarded-For $remote_addr;
</span></span><span style="display:flex;"><span>        proxy_set_header   Host $http_host;
</span></span><span style="display:flex;"><span>        proxy_pass         &#34;http://127.0.0.1:&lt;port&gt;&#34;;
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    listen 443 ssl; # managed by Certbot
</span></span><span style="display:flex;"><span>    ssl_certificate /etc/letsencrypt/live/&lt;subdomain.domain.tld&gt;/fullchain.pem; # managed by Certbot
</span></span><span style="display:flex;"><span>    ssl_certificate_key /etc/letsencrypt/live/&lt;subdomain.domain.tld&gt;/privkey.pem; # managed by Certbot
</span></span><span style="display:flex;"><span>    include /etc/letsencrypt/options-ssl-nginx.conf; # managed by Certbot
</span></span><span style="display:flex;"><span>    ssl_dhparam /etc/letsencrypt/ssl-dhparams.pem; # managed by Certbot
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>server {
</span></span><span style="display:flex;"><span>    if ($host = &lt;subdomain.domain.tld&gt;) {
</span></span><span style="display:flex;"><span>        return 301 https://$host$request_uri;
</span></span><span style="display:flex;"><span>    } # managed by Certbot
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    listen 80;
</span></span><span style="display:flex;"><span>    server_name &lt;subdomain.domain.tld&gt;;
</span></span><span style="display:flex;"><span>    return 404; # managed by Certbot
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><ul>
<li><a href="https://www.digitalocean.com/community/tutorials/how-to-install-nginx-on-ubuntu-22-04" target="_blank" rel="noopener">Detailed steps</a></li>
</ul>
<h1 id="lets-encrypt">Lets Encrypt <a href="#lets-encrypt" class="anchor">🔗</a></h1><ul>
<li>
<p>Free TLS/SSL certificates</p>
</li>
<li>
<p>Install certbot</p>
</li>
</ul>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-fallback" data-lang="fallback"><span style="display:flex;"><span>sudo apt install certbot python3-certbot-nginx
</span></span></code></pre></div><ul>
<li>Obtaining SSL cert</li>
</ul>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-fallback" data-lang="fallback"><span style="display:flex;"><span>sudo certbot --nginx -d example.com -d www.example.com
</span></span></code></pre></div><ul>
<li><a href="https://www.digitalocean.com/community/tutorials/how-to-secure-nginx-with-let-s-encrypt-on-ubuntu-20-04" target="_blank" rel="noopener">Detailed steps</a></li>
</ul>
<h1 id="openvpn--pi-hole">OpenVPN + Pi-hole <a href="#openvpn--pi-hole" class="anchor">🔗</a></h1><ul>
<li>
<p>VPN with built in adblocker</p>
</li>
<li>
<p><a href="https://docs.pi-hole.net/guides/vpn/openvpn/installation/" target="_blank" rel="noopener">Detailed steps</a></p>
</li>
</ul>
<h1 id="transmission">Transmission <a href="#transmission" class="anchor">🔗</a></h1><ul>
<li>
<p>Torrents ♥</p>
</li>
<li>
<p>Install</p>
</li>
</ul>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-fallback" data-lang="fallback"><span style="display:flex;"><span>sudo add-apt-repository ppa:transmissionbt/ppa
</span></span><span style="display:flex;"><span>sudo apt-get update
</span></span><span style="display:flex;"><span>sudo apt-get install transmission-cli transmission-common transmission-daemon
</span></span></code></pre></div><ul>
<li>Configure</li>
</ul>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-fallback" data-lang="fallback"><span style="display:flex;"><span>sudo service transmission-daemon stop
</span></span><span style="display:flex;"><span>sudo vim /var/lib/transmission-daemon/info/settings.json
</span></span></code></pre></div><ul>
<li>Change the following</li>
</ul>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-fallback" data-lang="fallback"><span style="display:flex;"><span>&#34;rpc-password&#34;: &#34;&lt;new password&gt;&#34;,
</span></span><span style="display:flex;"><span>&#34;rpc-username&#34;: &#34;&lt;new username&gt;&#34;,
</span></span><span style="display:flex;"><span>&#34;rpc-whitelist&#34;: &#34;127.0.0.1,192.168.*.*&#34;,
</span></span><span style="display:flex;"><span>&#34;umask&#34;: 2,
</span></span></code></pre></div><ul>
<li>Restart</li>
</ul>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-fallback" data-lang="fallback"><span style="display:flex;"><span>sudo service transmission-daemon start
</span></span></code></pre></div><ul>
<li><a href="https://help.ubuntu.com/community/TransmissionHowTo" target="_blank" rel="noopener">Detailed steps</a></li>
</ul>
<h1 id="filebrowser">Filebrowser <a href="#filebrowser" class="anchor">🔗</a></h1><ul>
<li>View files on the server via browser</li>
</ul>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-fallback" data-lang="fallback"><span style="display:flex;"><span>curl -fsSL https://raw.githubusercontent.com/filebrowser/get/master/get.sh | bash
</span></span><span style="display:flex;"><span>filebrowser -r /path/to/your/files
</span></span></code></pre></div><ul>
<li><a href="https://filebrowser.org/installation" target="_blank" rel="noopener">Detailed steps</a></li>
</ul>

    </div>

    
        <div class="tags">
            
                <a href="https://tarunvelli.site/tags/openvpn">openvpn</a>
            
                <a href="https://tarunvelli.site/tags/pihole">pihole</a>
            
                <a href="https://tarunvelli.site/tags/transmission">transmission</a>
            
                <a href="https://tarunvelli.site/tags/bittorrent">bittorrent</a>
            
                <a href="https://tarunvelli.site/tags/filebrowser">filebrowser</a>
            
        </div>
    
    
    

</section>


    </main>
    
    <footer id="footer">
    
        <div id="social">


    <a class="symbol" href="mailto:tarunvelli@gmail.com" rel="me" target="_blank">
        
        <svg xmlns="http://www.w3.org/2000/svg" width="28" height="28" viewBox="0 0 24 24" stroke-width="2" stroke="#bbbbbb" fill="none" stroke-linecap="round" stroke-linejoin="round">
   <path stroke="none" d="M0 0h24v24H0z" fill="none"></path>
   <path d="M3 7a2 2 0 0 1 2 -2h14a2 2 0 0 1 2 2v10a2 2 0 0 1 -2 2h-14a2 2 0 0 1 -2 -2v-10z"></path>
   <path d="M3 7l9 6l9 -6"></path>
</svg>
    </a>

    <a class="symbol" href="https://github.com/tarunvelli" rel="me" target="_blank">
        
        <svg xmlns="http://www.w3.org/2000/svg" width="28" height="28" viewBox="0 0 24 24" stroke-width="2" stroke="#bbbbbb" fill="none" stroke-linecap="round" stroke-linejoin="round">
   <path stroke="none" d="M0 0h24v24H0z" fill="none"></path>
   <path d="M9 19c-4.3 1.4 -4.3 -2.5 -6 -3m12 5v-3.5c0 -1 .1 -1.4 -.5 -2c2.8 -.3 5.5 -1.4 5.5 -6a4.6 4.6 0 0 0 -1.3 -3.2a4.2 4.2 0 0 0 -.1 -3.2s-1.1 -.3 -3.5 1.3a12.3 12.3 0 0 0 -6.2 0c-2.4 -1.6 -3.5 -1.3 -3.5 -1.3a4.2 4.2 0 0 0 -.1 3.2a4.6 4.6 0 0 0 -1.3 3.2c0 4.6 2.7 5.7 5.5 6c-.6 .6 -.6 1.2 -.5 2v3.5"></path>
</svg>
    </a>

    <a class="symbol" href="https://www.linkedin.com/in/tarun-velli" rel="me" target="_blank">
        
        <svg xmlns="http://www.w3.org/2000/svg" width="28" height="28" viewBox="0 0 24 24" stroke-width="2" stroke="#bbbbbb" fill="none" stroke-linecap="round" stroke-linejoin="round">
   <path stroke="none" d="M0 0h24v24H0z" fill="none"></path>
   <path d="M4 4m0 2a2 2 0 0 1 2 -2h12a2 2 0 0 1 2 2v12a2 2 0 0 1 -2 2h-12a2 2 0 0 1 -2 -2z"></path>
   <path d="M8 11l0 5"></path>
   <path d="M8 8l0 .01"></path>
   <path d="M12 16l0 -5"></path>
   <path d="M16 16v-3a2 2 0 0 0 -4 0"></path>
</svg>
    </a>


</div>

    

    
</footer>



  </body>
</html>
